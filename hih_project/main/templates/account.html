{% extends 'base.html'%}
{% load static %}

{% block title %}
–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç
{% endblock %}



{% block content %}
<div class="account_page-container">
    
<br><br><br>
    <div class="account_page-content">
        {% if user.is_authenticated %}
        <!-- –®–∞–ø–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è -->
        <div class="account_page-header">
            <div class="account_page-welcome">
                <div class="account_page-user-info">
                    {% if user.avatar %}
                        <img src="{{ user.avatar.url }}" alt="–ê–≤–∞—Ç–∞—Ä" class="account_page-avatar">
                    {% else %}
                        <div class="account_page-avatar-placeholder">
                            {{ user.username|first|upper }}
                        </div>
                    {% endif %}
                    <div class="account_page-user-details">
                        <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {{ user.username }}!</h1>
                        <p class="account_page-user-email">{{ user.email }}</p>
                    </div>
                </div>
                <div class="account_page-actions">
                    <a href="{% url 'logout' %}" class="account_page-button account_page-button-secondary">–í—ã–π—Ç–∏</a>
                </div>
            </div>
            
            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div class="account_page-stats">
                <div class="account_page-stat-card">
                    <div class="account_page-stat-number">{{ user.bought_apps|length }}</div>
                    <div class="account_page-stat-label">–ö—É–ø–ª–µ–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</div>
                </div>
                <div class="account_page-stat-card">
                    <div class="account_page-stat-number">{{ user_estimations|length }}</div>
                    <div class="account_page-stat-label">–û—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –æ—Ü–µ–Ω–∫–∏</div>
                </div>
                <div class="account_page-stat-card">
                    <div class="account_page-stat-number">{{ user.achievements|length }}</div>
                    <div class="account_page-stat-label">–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</div>
                </div>
            </div>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã -->
        <div class="account_page-sections">
            <!-- –ö—É–ø–ª–µ–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
            <div class="account_page-section">
                <h2 class="account_page-section-title">–ö—É–ø–ª–µ–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</h2>
                <div class="account_page-apps-grid">
                    {% if user.bought_apps %}
                        {% for app_id in user.bought_apps %}
                        <div class="account_page-app-card">
                            <div class="account_page-app-icon-placeholder"></div>
                            <div class="account_page-app-info">
                                <div class="account_page-app-name">–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ #{{ forloop.counter }}</div>
                                <div class="account_page-app-category">ID: {{ app_id }}</div>
                            </div>
                        </div>
                        {% endfor %}
                    {% else %}
                        <div class="account_page-empty-state">
                            <div class="account_page-empty-icon">üì±</div>
                            <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∫—É–ø–ª–µ–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π</p>
                            <a href="{% url 'apps' %}" class="account_page-button account_page-button-primary" style="margin-top: 15px;">
                                –ù–∞–π—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
                            </a>
                        </div>
                    {% endif %}
                </div>
            </div>

            <!-- –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è -->
            <div class="account_page-section">
                <h2 class="account_page-section-title">–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h2>
                <div class="account_page-apps-grid">
                    {% if user.achievements %}
                        {% for achievement in user.achievements %}
                        <div class="account_page-app-card">
                            <div class="account_page-app-icon-placeholder" style="background: #ffd700;"></div>
                            <div class="account_page-app-info">
                                <div class="account_page-app-name">–î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ #{{ forloop.counter }}</div>
                                <div class="account_page-app-category">ID: {{ achievement }}</div>
                            </div>
                        </div>
                        {% endfor %}
                    {% else %}
                        <div class="account_page-empty-state">
                            <div class="account_page-empty-icon">üèÜ</div>
                            <p>–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ø–æ–∫–∞ –Ω–µ –ø–æ–ª—É—á–µ–Ω—ã</p>
                        </div>
                    {% endif %}
                </div>
            </div>

            <!-- –û—Ü–µ–Ω–∫–∏ -->
            <div class="account_page-section">
                <h2 class="account_page-section-title">–í–∞—à–∏ –æ—Ü–µ–Ω–∫–∏</h2>
                <div class="account_page-apps-grid">
                    {% if user_estimations %}
                        {% for estimation in user_estimations %}
                        <a class="account_page-app-card" href="{% url 'app_detail' app_id=estimation.app.id %}">
                            <img class="account_page-app-icon-placeholder" src="{{ estimation.app.icon.url }}"></img>
                            <div class="account_page-app-info">
                                <div class="account_page-app-name">–û—Ç–∑—ã–≤ –Ω–∞ –∏–≥—Ä—É "{{ estimation.app.name }}"</div>
                                <div class="account_page-app-category">–†–µ–π—Ç–∏–Ω–≥: {{ estimation.estimation|floatformat }}/5</div>
                            </div>
                        </a>
                        {% endfor %}
                    {% else %}
                        <div class="account_page-empty-state">
                            <div class="account_page-empty-icon">‚≠ê</div>
                            <p>–í—ã –µ—â–µ –Ω–µ –æ—Å—Ç–∞–≤–ª—è–ª–∏ –æ—Ü–µ–Ω–æ–∫</p>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>

        {% else %}
        <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
        <div class="account_page-header">
            <div class="account_page-empty-state">
                <div class="account_page-empty-icon">üîí</div>
                <h2>–í—ã –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã</h2>
                <p>–î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ª–∏—á–Ω–æ–º—É –∫–∞–±–∏–Ω–µ—Ç—É –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É</p>
                <div class="account_page-actions" style="justify-content: center;">
                    <a href="{% url 'login' %}" class="account_page-button account_page-button-primary">–í–æ–π—Ç–∏</a>
                    <a href="{% url 'signup' %}" class="account_page-button account_page-button-secondary">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a>
                </div>
            </div>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}