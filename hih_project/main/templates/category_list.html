{% extends 'base.html' %}
{% load static %}

{% block title %}
Категории — HiH Store
{% endblock %}

{% block content %}
<div class="cat-page">

    <!-- Заголовок -->
    <h1 class="cat-title">Выберите категорию</h1>

    <form method="post" class="cat-form">
        {% csrf_token %}

        <!-- Категории -->
        <div class="cat-grid">
            {% for category in categories %}
                <button type="submit"
                        class="cat-card"
                        name="category_id"
                        value="{{ category.id }}"
                        title="{{ category.description }}">
                    <span class="cat-card-name">{{ category.name }}</span>
                </button>
            {% endfor %}
        </div>

        {% if selected_category %}
            <h2 class="subcat-title">Подкатегории: {{ selected_category.name }}</h2>

            {% if subcategories %}
            <div class="cat-grid subcat-grid">
                {% for subcategory in subcategories %}
                    <button type="submit"
                            class="cat-card subcat-card"
                            name="subcategory_id"
                            value="{{ subcategory.id }}"
                            title="{{ subcategory.description }}">
                        <span class="cat-card-name">{{ subcategory.name }}</span>
                    </button>
                {% endfor %}
            </div>
            {% endif %}

            {% if apps %}
            <div class="apps-grid">
                {% for el in apps %}
                <a href="{% url 'app_detail' app_id=el.id %}" class="app-card">

                    <img src="{{ el.icon.url }}" class="app-card-icon" alt="{{ el.name }}">

                    <div class="app-card-info">
                        <h3 class="app-card-title">{{ el.name }}</h3>
                        <p class="app-card-cat">{{ el.subcategory.name }}</p>
                        <p class="app-card-rating">⭐ {{ el.rating }}</p>
                    </div>

                </a>
                {% endfor %}
            </div>
            {% else %}
            <h2 class="no-apps">Нет приложений</h2>
            {% endif %}
        {% endif %}

    </form>
</div>
{% endblock %}
